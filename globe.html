<html lang="en">

<head>
    <style>
        .lands {
            fill: transparent;
            stroke: rgba(0, 0, 0, 1);
            stroke-width: 1px;
        }

        .cities {
            stroke: #2f4f4f;
            stroke-width: 12px;
            fill: black;
            opacity: 0.8;
        }

        .cir {
            fill: none;
            stroke: black;
        }
    </style>
</head>

<body translate="no">
    <html>

    <head>
        <title>Globe</title>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://d3js.org/topojson.v1.min.js"></script>
    </head>

    <body>
        <div id="map" text-align="center" style="width:100%; height:100%;">
            <div id="globe"></div>
        </div>
    </body>

    </html>
    <script id="rendered-js">
        /* Set up */
        /* ====== */
        var timer;
        var width = 1000,
            height = 700,
            radius = 325,
            originalScale = height / 2,
            scale = originalScale,
            translation = [width / 2, height / 2],
            scaleChange,
            rotation,
            rotate = [100, -1],
            velocity = [0.009, 0],
            time = Date.now();
        var graticule = d3.geoGraticule();
        // set up the main canvas and the projection
        var svg = d3.
            select("#map").
            append("svg").
            attr("id", "world").
            attr("width", width).
            attr("height", height).
            append("g");
        var projection = d3.
            geoOrthographic().
            scale(radius).
            translate(translation).
            clipAngle(180);
        var path = d3.
            geoPath().
            projection(projection).
            pointRadius(1);
     
        /* Data load */
        /* ========= */
        d3.
            queue().
            defer(d3.csv, "https://rawgit.com/Bramsiss/Globe/master/c.csv").
            defer(
                d3.json,
                "https://rawgit.com/jonataswalker/map-utils/master/data/json/world-110m.json").
            await(load);
        function load(error, cities, world) {
            if (error) {
                console.log(error);
            }
            var land = topojson.feature(world, world.objects.land),
                grid = graticule();
            var outerArray = [];

            var points = {
                type: "MultiPoint",
                coordinates: outerArray
            };
            // Draw the world
            var world = svg.
                selectAll(".lands").
                data([land]).
                enter().
                append("path").
                attr("class", "lands").
                attr("d", path);
            // Draw the cities

            //Countries
            d3.json(
                "https://rawgit.com/Bramsiss/Globe/master/world-counries1.json",
                function (collection) {

                    //Rotation
                    var feature = svg.selectAll(".lands");
                    timer = d3.timer(function () {
                        var dt = Date.now() - time;
                        projection.rotate([rotate[0] + velocity[0] * dt, 0]);
                        feature.attr("d", path);
                    });
                });
        }
    </script>
</body>

</html>